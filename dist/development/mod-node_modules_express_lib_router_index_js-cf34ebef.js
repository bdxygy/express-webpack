"use strict";exports.id="mod-node_modules_express_lib_router_index_js-cf34ebef",exports.ids=["mod-node_modules_express_lib_router_index_js-cf34ebef"],exports.modules={"./node_modules/express/lib/router/index.js":(e,r,t)=>{var n=t("./node_modules/express/lib/router/route.js"),s=t("./node_modules/express/lib/router/layer.js"),a=t("./node_modules/methods/index.js"),i=t("./node_modules/utils-merge/index.js"),o=t("./node_modules/debug/src/index.js")("express:router"),u=t("./node_modules/depd/index.js")("express"),l=t("./node_modules/array-flatten/array-flatten.js"),f=t("./node_modules/parseurl/index.js"),c=t("./node_modules/setprototypeof/index.js"),d=/^\[object (\S+)\]$/,h=Array.prototype.slice,p=Object.prototype.toString,m=e.exports=function(e){var r=e||{};function t(e,r,n){t.handle(e,r,n)}return c(t,m),t.params={},t._params=[],t.caseSensitive=r.caseSensitive,t.mergeParams=r.mergeParams,t.strict=r.strict,t.stack=[],t};function v(e,r){for(var t=0;t<r.length;t++){var n=r[t];-1===e.indexOf(n)&&e.push(n)}}function g(e){var r=typeof e;return"object"!==r?r:p.call(e).replace(d,"$1")}function y(e,r){try{return e.match(r)}catch(e){return e}}m.param=function(e,r){if("function"==typeof e)return u("router.param(fn): Refactor to use path params"),void this._params.push(e);var t,n=this._params,s=n.length;":"===e[0]&&(u("router.param("+JSON.stringify(e)+", fn): Use router.param("+JSON.stringify(e.slice(1))+", fn) instead"),e=e.slice(1));for(var a=0;a<s;++a)(t=n[a](e,r))&&(r=t);if("function"!=typeof r)throw new Error("invalid param() call for "+e+", got "+r);return(this.params[e]=this.params[e]||[]).push(r),this},m.handle=function(e,r,t){var n=this;o("dispatching %s %s",e.method,e.url);var s,a,u=0,l=function(e){if("string"!=typeof e||0===e.length||"/"===e[0])return;var r=e.indexOf("?"),t=-1!==r?r:e.length,n=e.slice(0,t).indexOf("://");return-1!==n?e.substring(0,e.indexOf("/",3+n)):void 0}(e.url)||"",c="",d=!1,h=0,p={},m=[],g=n.stack,_=e.params,x=e.baseUrl||"",b=function(e,r){for(var t=new Array(arguments.length-2),n=new Array(arguments.length-2),s=0;s<t.length;s++)t[s]=arguments[s+2],n[s]=r[t[s]];return function(){for(var s=0;s<t.length;s++)r[t[s]]=n[s];return e.apply(this,arguments)}}(t,e,"baseUrl","next","params");function j(t){var s="route"===t?null:t;if(d&&(e.url=e.url.slice(1),d=!1),0!==c.length&&(e.baseUrl=x,e.url=l+c+e.url.slice(l.length),c=""),"router"!==s)if(u>=g.length)setImmediate(b,s);else{if(++h>100)return setImmediate(j,t);var a,w,O,S=function(e){try{return f(e).pathname}catch(e){return}}(e);if(null==S)return b(s);for(;!0!==w&&u<g.length;)if(w=y(a=g[u++],S),O=a.route,"boolean"!=typeof w&&(s=s||w),!0===w&&O)if(s)w=!1;else{var U=e.method,A=O._handles_method(U);A||"OPTIONS"!==U||v(m,O._options()),A||"HEAD"===U||(w=!1)}if(!0!==w)return b(s);O&&(e.route=O),e.params=n.mergeParams?function(e,r){if("object"!=typeof r||!r)return e;var t=i({},r);if(!(0 in e)||!(0 in r))return i(t,e);var n=0,s=0;for(;n in e;)n++;for(;s in r;)s++;for(n--;n>=0;n--)e[n+s]=e[n],n<s&&delete e[n];return i(t,e)}(a.params,_):a.params;var k=a.path;n.process_params(a,p,e,r,(function(t){t?j(s||t):O?a.handle_request(e,r,j):function(t,n,s,a){if(0!==s.length){if(s!==a.slice(0,s.length))return void j(n);var i=a[s.length];if(i&&"/"!==i&&"."!==i)return j(n);o("trim prefix (%s) from url %s",s,e.url),c=s,e.url=l+e.url.slice(l.length+c.length),l||"/"===e.url[0]||(e.url="/"+e.url,d=!0),e.baseUrl=x+("/"===c[c.length-1]?c.substring(0,c.length-1):c)}o("%s %s : %s",t.name,s,e.originalUrl),n?t.handle_error(n,e,r,j):t.handle_request(e,r,j)}(a,s,k,S),h=0}))}else setImmediate(b,null)}e.next=j,"OPTIONS"===e.method&&(s=b,a=function(e,t){if(t||0===m.length)return e(t);!function(e,r,t){try{var n=r.join(",");e.set("Allow",n),e.send(n)}catch(e){t(e)}}(r,m,e)},b=function(){var e=new Array(arguments.length+1);e[0]=s;for(var r=0,t=arguments.length;r<t;r++)e[r+1]=arguments[r];a.apply(this,e)}),e.baseUrl=x,e.originalUrl=e.originalUrl||e.url,j()},m.process_params=function(e,r,t,n,s){var a=this.params,i=e.keys;if(!i||0===i.length)return s();var o,u,l,f,c,d=0,h=0;function p(e){return e?s(e):d>=i.length?s():(h=0,u=i[d++],o=u.name,l=t.params[o],f=a[o],c=r[o],void 0!==l&&f?c&&(c.match===l||c.error&&"route"!==c.error)?(t.params[o]=c.value,p(c.error)):(r[o]=c={error:null,match:l,value:l},void m()):p())}function m(e){var r=f[h++];if(c.value=t.params[u.name],e)return c.error=e,void p(e);if(!r)return p();try{r(t,n,m,l,u.name)}catch(e){m(e)}}p()},m.use=function(e){var r=0,t="/";if("function"!=typeof e){for(var n=e;Array.isArray(n)&&0!==n.length;)n=n[0];"function"!=typeof n&&(r=1,t=e)}var a=l(h.call(arguments,r));if(0===a.length)throw new TypeError("Router.use() requires a middleware function");for(var i=0;i<a.length;i++){if("function"!=typeof(e=a[i]))throw new TypeError("Router.use() requires a middleware function but got a "+g(e));o("use %o %s",t,e.name||"<anonymous>");var u=new s(t,{sensitive:this.caseSensitive,strict:!1,end:!1},e);u.route=void 0,this.stack.push(u)}return this},m.route=function(e){var r=new n(e),t=new s(e,{sensitive:this.caseSensitive,strict:this.strict,end:!0},r.dispatch.bind(r));return t.route=r,this.stack.push(t),r},a.concat("all").forEach((function(e){m[e]=function(r){var t=this.route(r);return t[e].apply(t,h.call(arguments,1)),this}}))}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kLW5vZGVfbW9kdWxlc19leHByZXNzX2xpYl9yb3V0ZXJfaW5kZXhfanMtY2YzNGViZWYuanMiLCJtYXBwaW5ncyI6IjhOQWVBLElBQUlBLEVBQVEsRUFBUSw4Q0FDaEJDLEVBQVEsRUFBUSw4Q0FDaEJDLEVBQVUsRUFBUSxtQ0FDbEJDLEVBQVEsRUFBUSx1Q0FDaEJDLEVBQVEsRUFBUSxvQ0FBUixDQUFpQixrQkFDekJDLEVBQVksRUFBUSwrQkFBUixDQUFnQixXQUM1QkMsRUFBVSxFQUFRLGlEQUNsQkMsRUFBVyxFQUFRLG9DQUNuQkMsRUFBaUIsRUFBUSwwQ0FPekJDLEVBQWUscUJBQ2ZDLEVBQVFDLE1BQU1DLFVBQVVGLE1BQ3hCRyxFQUFXQyxPQUFPRixVQUFVQyxTQVU1QkUsRUFBUUMsRUFBT0MsUUFBVSxTQUFTQyxHQUNwQyxJQUFJQyxFQUFPRCxHQUFXLENBQUMsRUFFdkIsU0FBU0UsRUFBT0MsRUFBS0MsRUFBS0MsR0FDeEJILEVBQU9JLE9BQU9ILEVBQUtDLEVBQUtDLEVBQzFCLENBWUEsT0FUQWYsRUFBZVksRUFBUUwsR0FFdkJLLEVBQU9LLE9BQVMsQ0FBQyxFQUNqQkwsRUFBT00sUUFBVSxHQUNqQk4sRUFBT08sY0FBZ0JSLEVBQUtRLGNBQzVCUCxFQUFPUSxZQUFjVCxFQUFLUyxZQUMxQlIsRUFBT1MsT0FBU1YsRUFBS1UsT0FDckJULEVBQU9VLE1BQVEsR0FFUlYsQ0FDVCxFQWtkQSxTQUFTVyxFQUFjQyxFQUFNQyxHQUMzQixJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSUQsRUFBU0UsT0FBUUQsSUFBSyxDQUN4QyxJQUFJRSxFQUFTSCxFQUFTQyxJQUNRLElBQTFCRixFQUFLSyxRQUFRRCxJQUNmSixFQUFLTSxLQUFLRixFQUVkLENBQ0YsQ0E2QkEsU0FBU0csRUFBUUMsR0FDZixJQUFJQyxTQUFjRCxFQUVsQixNQUFhLFdBQVRDLEVBQ0tBLEVBSUY1QixFQUFTNkIsS0FBS0YsR0FDbEJHLFFBQVFsQyxFQUFjLEtBQzNCLENBVUEsU0FB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QUFZbkgsRUFBUUksRUFBTWdDLEtBQUtxQyxVQUFXdUMsSUFFOUMsR0FBeUIsSUFBckJHLEVBQVV0RixPQUNaLE1BQU0sSUFBSXVGLFVBQVUsK0NBR3RCLElBQUssSUFBSXhGLEVBQUksRUFBR0EsRUFBSXVGLEVBQVV0RixPQUFRRCxJQUFLLENBR3pDLEdBQWtCLG1CQUZkaUIsRUFBS3NFLEVBQVV2RixJQUdqQixNQUFNLElBQUl3RixVQUFVLHlEQUEyRG5GLEVBQVFZLElBSXpGL0MsRUFBTSxZQUFhMEMsRUFBTUssRUFBR0QsTUFBUSxlQUVwQyxJQUFJTCxFQUFRLElBQUk1QyxFQUFNNkMsRUFBTSxDQUMxQjZFLFVBQVd2RSxLQUFLekIsY0FDaEJFLFFBQVEsRUFDUitGLEtBQUssR0FDSnpFLEdBRUhOLEVBQU13QyxXQUFRakIsRUFFZGhCLEtBQUt0QixNQUFNUSxLQUFLTyxFQUNsQixDQUVBLE9BQU9PLElBQ1QsRUFlQXJDLEVBQU1zRSxNQUFRLFNBQWV2QyxHQUMzQixJQUFJdUMsRUFBUSxJQUFJckYsRUFBTThDLEdBRWxCRCxFQUFRLElBQUk1QyxFQUFNNkMsRUFBTSxDQUMxQjZFLFVBQVd2RSxLQUFLekIsY0FDaEJFLE9BQVF1QixLQUFLdkIsT0FDYitGLEtBQUssR0FDSnZDLEVBQU13QyxTQUFTQyxLQUFLekMsSUFLdkIsT0FIQXhDLEVBQU13QyxNQUFRQSxFQUVkakMsS0FBS3RCLE1BQU1RLEtBQUtPLEdBQ1R3QyxDQUNULEVBR0FuRixFQUFRNkgsT0FBTyxPQUFPQyxTQUFRLFNBQVM1RixHQUNyQ3JCLEVBQU1xQixHQUFVLFNBQVNVLEdBQ3ZCLElBQUl1QyxFQUFRakMsS0FBS2lDLE1BQU12QyxHQUV2QixPQURBdUMsRUFBTWpELEdBQVE2QyxNQUFNSSxFQUFPM0UsRUFBTWdDLEtBQUtxQyxVQUFXLElBQzFDM0IsSUFDVCxDQUNGLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AYmR4eWd5L2V4cHJlc3Mtd2VicGFjay8uL25vZGVfbW9kdWxlcy9leHByZXNzL2xpYi9yb3V0ZXIvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBleHByZXNzXG4gKiBDb3B5cmlnaHQoYykgMjAwOS0yMDEzIFRKIEhvbG93YXljaHVrXG4gKiBDb3B5cmlnaHQoYykgMjAxMyBSb21hbiBTaHR5bG1hblxuICogQ29weXJpZ2h0KGMpIDIwMTQtMjAxNSBEb3VnbGFzIENocmlzdG9waGVyIFdpbHNvblxuICogTUlUIExpY2Vuc2VkXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIE1vZHVsZSBkZXBlbmRlbmNpZXMuXG4gKiBAcHJpdmF0ZVxuICovXG5cbnZhciBSb3V0ZSA9IHJlcXVpcmUoJy4vcm91dGUnKTtcbnZhciBMYXllciA9IHJlcXVpcmUoJy4vbGF5ZXInKTtcbnZhciBtZXRob2RzID0gcmVxdWlyZSgnbWV0aG9kcycpO1xudmFyIG1peGluID0gcmVxdWlyZSgndXRpbHMtbWVyZ2UnKTtcbnZhciBkZWJ1ZyA9IHJlcXVpcmUoJ2RlYnVnJykoJ2V4cHJlc3M6cm91dGVyJyk7XG52YXIgZGVwcmVjYXRlID0gcmVxdWlyZSgnZGVwZCcpKCdleHByZXNzJyk7XG52YXIgZmxhdHRlbiA9IHJlcXVpcmUoJ2FycmF5LWZsYXR0ZW4nKTtcbnZhciBwYXJzZVVybCA9IHJlcXVpcmUoJ3BhcnNldXJsJyk7XG52YXIgc2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCdzZXRwcm90b3R5cGVvZicpXG5cbi8qKlxuICogTW9kdWxlIHZhcmlhYmxlcy5cbiAqIEBwcml2YXRlXG4gKi9cblxudmFyIG9iamVjdFJlZ0V4cCA9IC9eXFxbb2JqZWN0IChcXFMrKVxcXSQvO1xudmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xudmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuLyoqXG4gKiBJbml0aWFsaXplIGEgbmV3IGBSb3V0ZXJgIHdpdGggdGhlIGdpdmVuIGBvcHRpb25zYC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXG4gKiBAcmV0dXJuIHtSb3V0ZXJ9IHdoaWNoIGlzIGFuIGNhbGxhYmxlIGZ1bmN0aW9uXG4gKiBAcHVibGljXG4gKi9cblxudmFyIHByb3RvID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gIHZhciBvcHRzID0gb3B0aW9ucyB8fCB7fTtcblxuICBmdW5jdGlvbiByb3V0ZXIocmVxLCByZXMsIG5leHQpIHtcbiAgICByb3V0ZXIuaGFuZGxlKHJlcSwgcmVzLCBuZXh0KTtcbiAgfVxuXG4gIC8vIG1peGluIFJvdXRlciBjbGFzcyBmdW5jdGlvbnNcbiAgc2V0UHJvdG90eXBlT2Yocm91dGVyLCBwcm90bylcblxuICByb3V0ZXIucGFyYW1zID0ge307XG4gIHJvdXRlci5fcGFyYW1zID0gW107XG4gIHJvdXRlci5jYXNlU2Vuc2l0aXZlID0gb3B0cy5jYXNlU2Vuc2l0aXZlO1xuICByb3V0ZXIubWVyZ2VQYXJhbXMgPSBvcHRzLm1lcmdlUGFyYW1zO1xuICByb3V0ZXIuc3RyaWN0ID0gb3B0cy5zdHJpY3Q7XG4gIHJvdXRlci5zdGFjayA9IFtdO1xuXG4gIHJldHVybiByb3V0ZXI7XG59O1xuXG4vKipcbiAqIE1hcCB0aGUgZ2l2ZW4gcGFyYW0gcGxhY2Vob2xkZXIgYG5hbWVgKHMpIHRvIHRoZSBnaXZlbiBjYWxsYmFjay5cbiAqXG4gKiBQYXJhbWV0ZXIgbWFwcGluZyBpcyB1c2VkIHRvIHByb3ZpZGUgcHJlLWNvbmRpdGlvbnMgdG8gcm91dGVzXG4gKiB3aGljaCB1c2Ugbm9ybWFsaXplZCBwbGFjZWhvbGRlcnMuIEZvciBleGFtcGxlIGEgXzp1c2VyX2lkXyBwYXJhbWV0ZXJcbiAqIGNvdWxkIGF1dG9tYXRpY2FsbHkgbG9hZCBhIHVzZXIncyBpbmZvcm1hdGlvbiBmcm9tIHRoZSBkYXRhYmFzZSB3aXRob3V0XG4gKiBhbnkgYWRkaXRpb25hbCBjb2RlLFxuICpcbiAqIFRoZSBjYWxsYmFjayB1c2VzIHRoZSBzYW1lIHNpZ25hdHVyZSBhcyBtaWRkbGV3YXJlLCB0aGUgb25seSBkaWZmZXJlbmNlXG4gKiBiZWluZyB0aGF0IHRoZSB2YWx1ZSBvZiB0aGUgcGxhY2Vob2xkZXIgaXMgcGFzc2VkLCBpbiB0aGlzIGNhc2UgdGhlIF9pZF9cbiAqIG9mIHRoZSB1c2VyLiBPbmNlIHRoZSBgbmV4dCgpYCBmdW5jdGlvbiBpcyBpbnZva2VkLCBqdXN0IGxpa2UgbWlkZGxld2FyZVxuICogaXQgd2lsbCBjb250aW51ZSBvbiB0byBleGVjdXRlIHRoZSByb3V0ZSwgb3Igc3Vic2VxdWVudCBwYXJhbWV0ZXIgZnVuY3Rpb25zLlxuICpcbiAqIEp1c3QgbGlrZSBpbiBtaWRkbGV3YXJlLCB5b3UgbXVzdCBlaXRoZXIgcmVzcG9uZCB0byB0aGUgcmVxdWVzdCBvciBjYWxsIG5leHRcbiAqIHRvIGF2b2lkIHN0YWxsaW5nIHRoZSByZXF1ZXN0LlxuICpcbiAqICBhcHAucGFyYW0oJ3VzZXJfaWQnLCBmdW5jdGlvbihyZXEsIHJlcywgbmV4dCwgaWQpe1xuICogICAgVXNlci5maW5kKGlkLCBmdW5jdGlvbihlcnIsIHVzZXIpe1xuICogICAgICBpZiAoZXJyKSB7XG4gKiAgICAgICAgcmV0dXJuIG5leHQoZXJyKTtcbiAqICAgICAgfSBlbHNlIGlmICghdXNlcikge1xuICogICAgICAgIHJldHVybiBuZXh0KG5ldyBFcnJvcignZmFpbGVkIHRvIGxvYWQgdXNlcicpKTtcbiAqICAgICAgfVxuICogICAgICByZXEudXNlciA9IHVzZXI7XG4gKiAgICAgIG5leHQoKTtcbiAqICAgIH0pO1xuICogIH0pO1xuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICogQHJldHVybiB7YXBwfSBmb3IgY2hhaW5pbmdcbiAqIEBwdWJsaWNcbiAqL1xuXG5wcm90by5wYXJhbSA9IGZ1bmN0aW9uIHBhcmFtKG5hbWUsIGZuKSB7XG4gIC8vIHBhcmFtIGxvZ2ljXG4gIGlmICh0eXBlb2YgbmFtZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGRlcHJlY2F0ZSgncm91dGVyLnBhcmFtKGZuKTogUmVmYWN0b3IgdG8gdXNlIHBhdGggcGFyYW1zJyk7XG4gICAgdGhpcy5fcGFyYW1zLnB1c2gobmFtZSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gYXBwbHkgcGFyYW0gZnVuY3Rpb25zXG4gIHZhciBwYXJhbXMgPSB0aGlzLl9wYXJhbXM7XG4gIHZhciBsZW4gPSBwYXJhbXMubGVuZ3RoO1xuICB2YXIgcmV0O1xuXG4gIGlmIChuYW1lWzBdID09PSAnOicpIHtcbiAgICBkZXByZWNhdGUoJ3JvdXRlci5wYXJhbSgnICsgSlNPTi5zdHJpbmdpZnkobmFtZSkgKyAnLCBmbik6IFVzZSByb3V0ZXIucGFyYW0oJyArIEpTT04uc3RyaW5naWZ5KG5hbWUuc2xpY2UoMSkpICsgJywgZm4pIGluc3RlYWQnKVxuICAgIG5hbWUgPSBuYW1lLnNsaWNlKDEpXG4gIH1cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKHJldCA9IHBhcmFtc1tpXShuYW1lLCBmbikpIHtcbiAgICAgIGZuID0gcmV0O1xuICAgIH1cbiAgfVxuXG4gIC8vIGVuc3VyZSB3ZSBlbmQgdXAgd2l0aCBhXG4gIC8vIG1pZGRsZXdhcmUgZnVuY3Rpb25cbiAgaWYgKCdmdW5jdGlvbicgIT09IHR5cGVvZiBmbikge1xuICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBwYXJhbSgpIGNhbGwgZm9yICcgKyBuYW1lICsgJywgZ290ICcgKyBmbik7XG4gIH1cblxuICAodGhpcy5wYXJhbXNbbmFtZV0gPSB0aGlzLnBhcmFtc1tuYW1lXSB8fCBbXSkucHVzaChmbik7XG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBEaXNwYXRjaCBhIHJlcSwgcmVzIGludG8gdGhlIHJvdXRlci5cbiAqIEBwcml2YXRlXG4gKi9cblxucHJvdG8uaGFuZGxlID0gZnVuY3Rpb24gaGFuZGxlKHJlcSwgcmVzLCBvdXQpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gIGRlYnVnKCdkaXNwYXRjaGluZyAlcyAlcycsIHJlcS5tZXRob2QsIHJlcS51cmwpO1xuXG4gIHZhciBpZHggPSAwO1xuICB2YXIgcHJvdG9ob3N0ID0gZ2V0UHJvdG9ob3N0KHJlcS51cmwpIHx8ICcnXG4gIHZhciByZW1vdmVkID0gJyc7XG4gIHZhciBzbGFzaEFkZGVkID0gZmFsc2U7XG4gIHZhciBzeW5jID0gMFxuICB2YXIgcGFyYW1jYWxsZWQgPSB7fTtcblxuICAvLyBzdG9yZSBvcHRpb25zIGZvciBPUFRJT05TIHJlcXVlc3RcbiAgLy8gb25seSB1c2VkIGlmIE9QVElPTlMgcmVxdWVzdFxuICB2YXIgb3B0aW9ucyA9IFtdO1xuXG4gIC8vIG1pZGRsZXdhcmUgYW5kIHJvdXRlc1xuICB2YXIgc3RhY2sgPSBzZWxmLnN0YWNrO1xuXG4gIC8vIG1hbmFnZSBpbnRlci1yb3V0ZXIgdmFyaWFibGVzXG4gIHZhciBwYXJlbnRQYXJhbXMgPSByZXEucGFyYW1zO1xuICB2YXIgcGFyZW50VXJsID0gcmVxLmJhc2VVcmwgfHwgJyc7XG4gIHZhciBkb25lID0gcmVzdG9yZShvdXQsIHJlcSwgJ2Jhc2VVcmwnLCAnbmV4dCcsICdwYXJhbXMnKTtcblxuICAvLyBzZXR1cCBuZXh0IGxheWVyXG4gIHJlcS5uZXh0ID0gbmV4dDtcblxuICAvLyBmb3Igb3B0aW9ucyByZXF1ZXN0cywgcmVzcG9uZCB3aXRoIGEgZGVmYXVsdCBpZiBub3RoaW5nIGVsc2UgcmVzcG9uZHNcbiAgaWYgKHJlcS5tZXRob2QgPT09ICdPUFRJT05TJykge1xuICAgIGRvbmUgPSB3cmFwKGRvbmUsIGZ1bmN0aW9uKG9sZCwgZXJyKSB7XG4gICAgICBpZiAoZXJyIHx8IG9wdGlvbnMubGVuZ3RoID09PSAwKSByZXR1cm4gb2xkKGVycik7XG4gICAgICBzZW5kT3B0aW9uc1Jlc3BvbnNlKHJlcywgb3B0aW9ucywgb2xkKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIHNldHVwIGJhc2ljIHJlcSB2YWx1ZXNcbiAgcmVxLmJhc2VVcmwgPSBwYXJlbnRVcmw7XG4gIHJlcS5vcmlnaW5hbFVybCA9IHJlcS5vcmlnaW5hbFVybCB8fCByZXEudXJsO1xuXG4gIG5leHQoKTtcblxuICBmdW5jdGlvbiBuZXh0KGVycikge1xuICAgIHZhciBsYXllckVycm9yID0gZXJyID09PSAncm91dGUnXG4gICAgICA/IG51bGxcbiAgICAgIDogZXJyO1xuXG4gICAgLy8gcmVtb3ZlIGFkZGVkIHNsYXNoXG4gICAgaWYgKHNsYXNoQWRkZWQpIHtcbiAgICAgIHJlcS51cmwgPSByZXEudXJsLnNsaWNlKDEpXG4gICAgICBzbGFzaEFkZGVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gcmVzdG9yZSBhbHRlcmVkIHJlcS51cmxcbiAgICBpZiAocmVtb3ZlZC5sZW5ndGggIT09IDApIHtcbiAgICAgIHJlcS5iYXNlVXJsID0gcGFyZW50VXJsO1xuICAgICAgcmVxLnVybCA9IHByb3RvaG9zdCArIHJlbW92ZWQgKyByZXEudXJsLnNsaWNlKHByb3RvaG9zdC5sZW5ndGgpXG4gICAgICByZW1vdmVkID0gJyc7XG4gICAgfVxuXG4gICAgLy8gc2lnbmFsIHRvIGV4aXQgcm91dGVyXG4gICAgaWYgKGxheWVyRXJyb3IgPT09ICdyb3V0ZXInKSB7XG4gICAgICBzZXRJbW1lZGlhdGUoZG9uZSwgbnVsbClcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIG5vIG1vcmUgbWF0Y2hpbmcgbGF5ZXJzXG4gICAgaWYgKGlkeCA+PSBzdGFjay5sZW5ndGgpIHtcbiAgICAgIHNldEltbWVkaWF0ZShkb25lLCBsYXllckVycm9yKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBtYXggc3luYyBzdGFja1xuICAgIGlmICgrK3N5bmMgPiAxMDApIHtcbiAgICAgIHJldHVybiBzZXRJbW1lZGlhdGUobmV4dCwgZXJyKVxuICAgIH1cblxuICAgIC8vIGdldCBwYXRobmFtZSBvZiByZXF1ZXN0XG4gICAgdmFyIHBhdGggPSBnZXRQYXRobmFtZShyZXEpO1xuXG4gICAgaWYgKHBhdGggPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGRvbmUobGF5ZXJFcnJvcik7XG4gICAgfVxuXG4gICAgLy8gZmluZCBuZXh0IG1hdGNoaW5nIGxheWVyXG4gICAgdmFyIGxheWVyO1xuICAgIHZhciBtYXRjaDtcbiAgICB2YXIgcm91dGU7XG5cbiAgICB3aGlsZSAobWF0Y2ggIT09IHRydWUgJiYgaWR4IDwgc3RhY2subGVuZ3RoKSB7XG4gICAgICBsYXllciA9IHN0YWNrW2lkeCsrXTtcbiAgICAgIG1hdGNoID0gbWF0Y2hMYXllcihsYXllciwgcGF0aCk7XG4gICAgICByb3V0ZSA9IGxheWVyLnJvdXRlO1xuXG4gICAgICBpZiAodHlwZW9mIG1hdGNoICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgLy8gaG9sZCBvbiB0byBsYXllckVycm9yXG4gICAgICAgIGxheWVyRXJyb3IgPSBsYXllckVycm9yIHx8IG1hdGNoO1xuICAgICAgfVxuXG4gICAgICBpZiAobWF0Y2ggIT09IHRydWUpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmICghcm91dGUpIHtcbiAgICAgICAgLy8gcHJvY2VzcyBub24tcm91dGUgaGFuZGxlcnMgbm9ybWFsbHlcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChsYXllckVycm9yKSB7XG4gICAgICAgIC8vIHJvdXRlcyBkbyBub3QgbWF0Y2ggd2l0aCBhIHBlbmRpbmcgZXJyb3JcbiAgICAgICAgbWF0Y2ggPSBmYWxzZTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBtZXRob2QgPSByZXEubWV0aG9kO1xuICAgICAgdmFyIGhhc19tZXRob2QgPSByb3V0ZS5faGFuZGxlc19tZXRob2QobWV0aG9kKTtcblxuICAgICAgLy8gYnVpbGQgdXAgYXV0b21hdGljIG9wdGlvbnMgcmVzcG9uc2VcbiAgICAgIGlmICghaGFzX21ldGhvZCAmJiBtZXRob2QgPT09ICdPUFRJT05TJykge1xuICAgICAgICBhcHBlbmRNZXRob2RzKG9wdGlvbnMsIHJvdXRlLl9vcHRpb25zKCkpO1xuICAgICAgfVxuXG4gICAgICAvLyBkb24ndCBldmVuIGJvdGhlciBtYXRjaGluZyByb3V0ZVxuICAgICAgaWYgKCFoYXNfbWV0aG9kICYmIG1ldGhvZCAhPT0gJ0hFQUQnKSB7XG4gICAgICAgIG1hdGNoID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gbm8gbWF0Y2hcbiAgICBpZiAobWF0Y2ggIT09IHRydWUpIHtcbiAgICAgIHJldHVybiBkb25lKGxheWVyRXJyb3IpO1xuICAgIH1cblxuICAgIC8vIHN0b3JlIHJvdXRlIGZvciBkaXNwYXRjaCBvbiBjaGFuZ2VcbiAgICBpZiAocm91dGUpIHtcbiAgICAgIHJlcS5yb3V0ZSA9IHJvdXRlO1xuICAgIH1cblxuICAgIC8vIENhcHR1cmUgb25lLXRpbWUgbGF5ZXIgdmFsdWVzXG4gICAgcmVxLnBhcmFtcyA9IHNlbGYubWVyZ2VQYXJhbXNcbiAgICAgID8gbWVyZ2VQYXJhbXMobGF5ZXIucGFyYW1zLCBwYXJlbnRQYXJhbXMpXG4gICAgICA6IGxheWVyLnBhcmFtcztcbiAgICB2YXIgbGF5ZXJQYXRoID0gbGF5ZXIucGF0aDtcblxuICAgIC8vIHRoaXMgc2hvdWxkIGJlIGRvbmUgZm9yIHRoZSBsYXllclxuICAgIHNlbGYucHJvY2Vzc19wYXJhbXMobGF5ZXIsIHBhcmFtY2FsbGVkLCByZXEsIHJlcywgZnVuY3Rpb24gKGVycikge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICBuZXh0KGxheWVyRXJyb3IgfHwgZXJyKVxuICAgICAgfSBlbHNlIGlmIChyb3V0ZSkge1xuICAgICAgICBsYXllci5oYW5kbGVfcmVxdWVzdChyZXEsIHJlcywgbmV4dClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRyaW1fcHJlZml4KGxheWVyLCBsYXllckVycm9yLCBsYXllclBhdGgsIHBhdGgpXG4gICAgICB9XG5cbiAgICAgIHN5bmMgPSAwXG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiB0cmltX3ByZWZpeChsYXllciwgbGF5ZXJFcnJvciwgbGF5ZXJQYXRoLCBwYXRoKSB7XG4gICAgaWYgKGxheWVyUGF0aC5sZW5ndGggIT09IDApIHtcbiAgICAgIC8vIFZhbGlkYXRlIHBhdGggaXMgYSBwcmVmaXggbWF0Y2hcbiAgICAgIGlmIChsYXllclBhdGggIT09IHBhdGguc2xpY2UoMCwgbGF5ZXJQYXRoLmxlbmd0aCkpIHtcbiAgICAgICAgbmV4dChsYXllckVycm9yKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgLy8gVmFsaWRhdGUgcGF0aCBicmVha3Mgb24gYSBwYXRoIHNlcGFyYXRvclxuICAgICAgdmFyIGMgPSBwYXRoW2xheWVyUGF0aC5sZW5ndGhdXG4gICAgICBpZiAoYyAmJiBjICE9PSAnLycgJiYgYyAhPT0gJy4nKSByZXR1cm4gbmV4dChsYXllckVycm9yKVxuXG4gICAgICAvLyBUcmltIG9mZiB0aGUgcGFydCBvZiB0aGUgdXJsIHRoYXQgbWF0Y2hlcyB0aGUgcm91dGVcbiAgICAgIC8vIG1pZGRsZXdhcmUgKC51c2Ugc3R1ZmYpIG5lZWRzIHRvIGhhdmUgdGhlIHBhdGggc3RyaXBwZWRcbiAgICAgIGRlYnVnKCd0cmltIHByZWZpeCAoJXMpIGZyb20gdXJsICVzJywgbGF5ZXJQYXRoLCByZXEudXJsKTtcbiAgICAgIHJlbW92ZWQgPSBsYXllclBhdGg7XG4gICAgICByZXEudXJsID0gcHJvdG9ob3N0ICsgcmVxLnVybC5zbGljZShwcm90b2hvc3QubGVuZ3RoICsgcmVtb3ZlZC5sZW5ndGgpXG5cbiAgICAgIC8vIEVuc3VyZSBsZWFkaW5nIHNsYXNoXG4gICAgICBpZiAoIXByb3RvaG9zdCAmJiByZXEudXJsWzBdICE9PSAnLycpIHtcbiAgICAgICAgcmVxLnVybCA9ICcvJyArIHJlcS51cmw7XG4gICAgICAgIHNsYXNoQWRkZWQgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXR1cCBiYXNlIFVSTCAobm8gdHJhaWxpbmcgc2xhc2gpXG4gICAgICByZXEuYmFzZVVybCA9IHBhcmVudFVybCArIChyZW1vdmVkW3JlbW92ZWQubGVuZ3RoIC0gMV0gPT09ICcvJ1xuICAgICAgICA/IHJlbW92ZWQuc3Vic3RyaW5nKDAsIHJlbW92ZWQubGVuZ3RoIC0gMSlcbiAgICAgICAgOiByZW1vdmVkKTtcbiAgICB9XG5cbiAgICBkZWJ1ZygnJXMgJXMgOiAlcycsIGxheWVyLm5hbWUsIGxheWVyUGF0aCwgcmVxLm9yaWdpbmFsVXJsKTtcblxuICAgIGlmIChsYXllckVycm9yKSB7XG4gICAgICBsYXllci5oYW5kbGVfZXJyb3IobGF5ZXJFcnJvciwgcmVxLCByZXMsIG5leHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsYXllci5oYW5kbGVfcmVxdWVzdChyZXEsIHJlcywgbmV4dCk7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgYW55IHBhcmFtZXRlcnMgZm9yIHRoZSBsYXllci5cbiAqIEBwcml2YXRlXG4gKi9cblxucHJvdG8ucHJvY2Vzc19wYXJhbXMgPSBmdW5jdGlvbiBwcm9jZXNzX3BhcmFtcyhsYXllciwgY2FsbGVkLCByZXEsIHJlcywgZG9uZSkge1xuICB2YXIgcGFyYW1zID0gdGhpcy5wYXJhbXM7XG5cbiAgLy8gY2FwdHVyZWQgcGFyYW1ldGVycyBmcm9tIHRoZSBsYXllciwga2V5cyBhbmQgdmFsdWVzXG4gIHZhciBrZXlzID0gbGF5ZXIua2V5cztcblxuICAvLyBmYXN0IHRyYWNrXG4gIGlmICgha2V5cyB8fCBrZXlzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBkb25lKCk7XG4gIH1cblxuICB2YXIgaSA9IDA7XG4gIHZhciBuYW1lO1xuICB2YXIgcGFyYW1JbmRleCA9IDA7XG4gIHZhciBrZXk7XG4gIHZhciBwYXJhbVZhbDtcbiAgdmFyIHBhcmFtQ2FsbGJhY2tzO1xuICB2YXIgcGFyYW1DYWxsZWQ7XG5cbiAgLy8gcHJvY2VzcyBwYXJhbXMgaW4gb3JkZXJcbiAgLy8gcGFyYW0gY2FsbGJhY2tzIGNhbiBiZSBhc3luY1xuICBmdW5jdGlvbiBwYXJhbShlcnIpIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICByZXR1cm4gZG9uZShlcnIpO1xuICAgIH1cblxuICAgIGlmIChpID49IGtleXMubGVuZ3RoICkge1xuICAgICAgcmV0dXJuIGRvbmUoKTtcbiAgICB9XG5cbiAgICBwYXJhbUluZGV4ID0gMDtcbiAgICBrZXkgPSBrZXlzW2krK107XG4gICAgbmFtZSA9IGtleS5uYW1lO1xuICAgIHBhcmFtVmFsID0gcmVxLnBhcmFtc1tuYW1lXTtcbiAgICBwYXJhbUNhbGxiYWNrcyA9IHBhcmFtc1tuYW1lXTtcbiAgICBwYXJhbUNhbGxlZCA9IGNhbGxlZFtuYW1lXTtcblxuICAgIGlmIChwYXJhbVZhbCA9PT0gdW5kZWZpbmVkIHx8ICFwYXJhbUNhbGxiYWNrcykge1xuICAgICAgcmV0dXJuIHBhcmFtKCk7XG4gICAgfVxuXG4gICAgLy8gcGFyYW0gcHJldmlvdXNseSBjYWxsZWQgd2l0aCBzYW1lIHZhbHVlIG9yIGVycm9yIG9jY3VycmVkXG4gICAgaWYgKHBhcmFtQ2FsbGVkICYmIChwYXJhbUNhbGxlZC5tYXRjaCA9PT0gcGFyYW1WYWxcbiAgICAgIHx8IChwYXJhbUNhbGxlZC5lcnJvciAmJiBwYXJhbUNhbGxlZC5lcnJvciAhPT0gJ3JvdXRlJykpKSB7XG4gICAgICAvLyByZXN0b3JlIHZhbHVlXG4gICAgICByZXEucGFyYW1zW25hbWVdID0gcGFyYW1DYWxsZWQudmFsdWU7XG5cbiAgICAgIC8vIG5leHQgcGFyYW1cbiAgICAgIHJldHVybiBwYXJhbShwYXJhbUNhbGxlZC5lcnJvcik7XG4gICAgfVxuXG4gICAgY2FsbGVkW25hbWVdID0gcGFyYW1DYWxsZWQgPSB7XG4gICAgICBlcnJvcjogbnVsbCxcbiAgICAgIG1hdGNoOiBwYXJhbVZhbCxcbiAgICAgIHZhbHVlOiBwYXJhbVZhbFxuICAgIH07XG5cbiAgICBwYXJhbUNhbGxiYWNrKCk7XG4gIH1cblxuICAvLyBzaW5nbGUgcGFyYW0gY2FsbGJhY2tzXG4gIGZ1bmN0aW9uIHBhcmFtQ2FsbGJhY2soZXJyKSB7XG4gICAgdmFyIGZuID0gcGFyYW1DYWxsYmFja3NbcGFyYW1JbmRleCsrXTtcblxuICAgIC8vIHN0b3JlIHVwZGF0ZWQgdmFsdWVcbiAgICBwYXJhbUNhbGxlZC52YWx1ZSA9IHJlcS5wYXJhbXNba2V5Lm5hbWVdO1xuXG4gICAgaWYgKGVycikge1xuICAgICAgLy8gc3RvcmUgZXJyb3JcbiAgICAgIHBhcmFtQ2FsbGVkLmVycm9yID0gZXJyO1xuICAgICAgcGFyYW0oZXJyKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIWZuKSByZXR1cm4gcGFyYW0oKTtcblxuICAgIHRyeSB7XG4gICAgICBmbihyZXEsIHJlcywgcGFyYW1DYWxsYmFjaywgcGFyYW1WYWwsIGtleS5uYW1lKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBwYXJhbUNhbGxiYWNrKGUpO1xuICAgIH1cbiAgfVxuXG4gIHBhcmFtKCk7XG59O1xuXG4vKipcbiAqIFVzZSB0aGUgZ2l2ZW4gbWlkZGxld2FyZSBmdW5jdGlvbiwgd2l0aCBvcHRpb25hbCBwYXRoLCBkZWZhdWx0aW5nIHRvIFwiL1wiLlxuICpcbiAqIFVzZSAobGlrZSBgLmFsbGApIHdpbGwgcnVuIGZvciBhbnkgaHR0cCBNRVRIT0QsIGJ1dCBpdCB3aWxsIG5vdCBhZGRcbiAqIGhhbmRsZXJzIGZvciB0aG9zZSBtZXRob2RzIHNvIE9QVElPTlMgcmVxdWVzdHMgd2lsbCBub3QgY29uc2lkZXIgYC51c2VgXG4gKiBmdW5jdGlvbnMgZXZlbiBpZiB0aGV5IGNvdWxkIHJlc3BvbmQuXG4gKlxuICogVGhlIG90aGVyIGRpZmZlcmVuY2UgaXMgdGhhdCBfcm91dGVfIHBhdGggaXMgc3RyaXBwZWQgYW5kIG5vdCB2aXNpYmxlXG4gKiB0byB0aGUgaGFuZGxlciBmdW5jdGlvbi4gVGhlIG1haW4gZWZmZWN0IG9mIHRoaXMgZmVhdHVyZSBpcyB0aGF0IG1vdW50ZWRcbiAqIGhhbmRsZXJzIGNhbiBvcGVyYXRlIHdpdGhvdXQgYW55IGNvZGUgY2hhbmdlcyByZWdhcmRsZXNzIG9mIHRoZSBcInByZWZpeFwiXG4gKiBwYXRobmFtZS5cbiAqXG4gKiBAcHVibGljXG4gKi9cblxucHJvdG8udXNlID0gZnVuY3Rpb24gdXNlKGZuKSB7XG4gIHZhciBvZmZzZXQgPSAwO1xuICB2YXIgcGF0aCA9ICcvJztcblxuICAvLyBkZWZhdWx0IHBhdGggdG8gJy8nXG4gIC8vIGRpc2FtYmlndWF0ZSByb3V0ZXIudXNlKFtmbl0pXG4gIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHtcbiAgICB2YXIgYXJnID0gZm47XG5cbiAgICB3aGlsZSAoQXJyYXkuaXNBcnJheShhcmcpICYmIGFyZy5sZW5ndGggIT09IDApIHtcbiAgICAgIGFyZyA9IGFyZ1swXTtcbiAgICB9XG5cbiAgICAvLyBmaXJzdCBhcmcgaXMgdGhlIHBhdGhcbiAgICBpZiAodHlwZW9mIGFyZyAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgb2Zmc2V0ID0gMTtcbiAgICAgIHBhdGggPSBmbjtcbiAgICB9XG4gIH1cblxuICB2YXIgY2FsbGJhY2tzID0gZmxhdHRlbihzbGljZS5jYWxsKGFyZ3VtZW50cywgb2Zmc2V0KSk7XG5cbiAgaWYgKGNhbGxiYWNrcy5sZW5ndGggPT09IDApIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdSb3V0ZXIudXNlKCkgcmVxdWlyZXMgYSBtaWRkbGV3YXJlIGZ1bmN0aW9uJylcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGZuID0gY2FsbGJhY2tzW2ldO1xuXG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignUm91dGVyLnVzZSgpIHJlcXVpcmVzIGEgbWlkZGxld2FyZSBmdW5jdGlvbiBidXQgZ290IGEgJyArIGdldHR5cGUoZm4pKVxuICAgIH1cblxuICAgIC8vIGFkZCB0aGUgbWlkZGxld2FyZVxuICAgIGRlYnVnKCd1c2UgJW8gJXMnLCBwYXRoLCBmbi5uYW1lIHx8ICc8YW5vbnltb3VzPicpXG5cbiAgICB2YXIgbGF5ZXIgPSBuZXcgTGF5ZXIocGF0aCwge1xuICAgICAgc2Vuc2l0aXZlOiB0aGlzLmNhc2VTZW5zaXRpdmUsXG4gICAgICBzdHJpY3Q6IGZhbHNlLFxuICAgICAgZW5kOiBmYWxzZVxuICAgIH0sIGZuKTtcblxuICAgIGxheWVyLnJvdXRlID0gdW5kZWZpbmVkO1xuXG4gICAgdGhpcy5zdGFjay5wdXNoKGxheWVyKTtcbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgUm91dGUgZm9yIHRoZSBnaXZlbiBwYXRoLlxuICpcbiAqIEVhY2ggcm91dGUgY29udGFpbnMgYSBzZXBhcmF0ZSBtaWRkbGV3YXJlIHN0YWNrIGFuZCBWRVJCIGhhbmRsZXJzLlxuICpcbiAqIFNlZSB0aGUgUm91dGUgYXBpIGRvY3VtZW50YXRpb24gZm9yIGRldGFpbHMgb24gYWRkaW5nIGhhbmRsZXJzXG4gKiBhbmQgbWlkZGxld2FyZSB0byByb3V0ZXMuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IHBhdGhcbiAqIEByZXR1cm4ge1JvdXRlfVxuICogQHB1YmxpY1xuICovXG5cbnByb3RvLnJvdXRlID0gZnVuY3Rpb24gcm91dGUocGF0aCkge1xuICB2YXIgcm91dGUgPSBuZXcgUm91dGUocGF0aCk7XG5cbiAgdmFyIGxheWVyID0gbmV3IExheWVyKHBhdGgsIHtcbiAgICBzZW5zaXRpdmU6IHRoaXMuY2FzZVNlbnNpdGl2ZSxcbiAgICBzdHJpY3Q6IHRoaXMuc3RyaWN0LFxuICAgIGVuZDogdHJ1ZVxuICB9LCByb3V0ZS5kaXNwYXRjaC5iaW5kKHJvdXRlKSk7XG5cbiAgbGF5ZXIucm91dGUgPSByb3V0ZTtcblxuICB0aGlzLnN0YWNrLnB1c2gobGF5ZXIpO1xuICByZXR1cm4gcm91dGU7XG59O1xuXG4vLyBjcmVhdGUgUm91dGVyI1ZFUkIgZnVuY3Rpb25zXG5tZXRob2RzLmNvbmNhdCgnYWxsJykuZm9yRWFjaChmdW5jdGlvbihtZXRob2Qpe1xuICBwcm90b1ttZXRob2RdID0gZnVuY3Rpb24ocGF0aCl7XG4gICAgdmFyIHJvdXRlID0gdGhpcy5yb3V0ZShwYXRoKVxuICAgIHJvdXRlW21ldGhvZF0uYXBwbHkocm91dGUsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG59KTtcblxuLy8gYXBwZW5kIG1ldGhvZHMgdG8gYSBsaXN0IG9mIG1ldGhvZHNcbmZ1bmN0aW9uIGFwcGVuZE1ldGhvZHMobGlzdCwgYWRkaXRpb24pIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhZGRpdGlvbi5sZW5ndGg7IGkrKykge1xuICAgIHZhciBtZXRob2QgPSBhZGRpdGlvbltpXTtcbiAgICBpZiAobGlzdC5pbmRleE9mKG1ldGhvZCkgPT09IC0xKSB7XG4gICAgICBsaXN0LnB1c2gobWV0aG9kKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gZ2V0IHBhdGhuYW1lIG9mIHJlcXVlc3RcbmZ1bmN0aW9uIGdldFBhdGhuYW1lKHJlcSkge1xuICB0cnkge1xuICAgIHJldHVybiBwYXJzZVVybChyZXEpLnBhdGhuYW1lO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG5cbi8vIEdldCBnZXQgcHJvdG9jb2wgKyBob3N0IGZvciBhIFVSTFxuZnVuY3Rpb24gZ2V0UHJvdG9ob3N0KHVybCkge1xuICBpZiAodHlwZW9mIHVybCAhPT0gJ3N0cmluZycgfHwgdXJsLmxlbmd0aCA9PT0gMCB8fCB1cmxbMF0gPT09ICcvJykge1xuICAgIHJldHVybiB1bmRlZmluZWRcbiAgfVxuXG4gIHZhciBzZWFyY2hJbmRleCA9IHVybC5pbmRleE9mKCc/JylcbiAgdmFyIHBhdGhMZW5ndGggPSBzZWFyY2hJbmRleCAhPT0gLTFcbiAgICA/IHNlYXJjaEluZGV4XG4gICAgOiB1cmwubGVuZ3RoXG4gIHZhciBmcWRuSW5kZXggPSB1cmwuc2xpY2UoMCwgcGF0aExlbmd0aCkuaW5kZXhPZignOi8vJylcblxuICByZXR1cm4gZnFkbkluZGV4ICE9PSAtMVxuICAgID8gdXJsLnN1YnN0cmluZygwLCB1cmwuaW5kZXhPZignLycsIDMgKyBmcWRuSW5kZXgpKVxuICAgIDogdW5kZWZpbmVkXG59XG5cbi8vIGdldCB0eXBlIGZvciBlcnJvciBtZXNzYWdlXG5mdW5jdGlvbiBnZXR0eXBlKG9iaikge1xuICB2YXIgdHlwZSA9IHR5cGVvZiBvYmo7XG5cbiAgaWYgKHR5cGUgIT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIHR5cGU7XG4gIH1cblxuICAvLyBpbnNwZWN0IFtbQ2xhc3NdXSBmb3Igb2JqZWN0c1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopXG4gICAgLnJlcGxhY2Uob2JqZWN0UmVnRXhwLCAnJDEnKTtcbn1cblxuLyoqXG4gKiBNYXRjaCBwYXRoIHRvIGEgbGF5ZXIuXG4gKlxuICogQHBhcmFtIHtMYXllcn0gbGF5ZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXG4gKiBAcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIG1hdGNoTGF5ZXIobGF5ZXIsIHBhdGgpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gbGF5ZXIubWF0Y2gocGF0aCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiBlcnI7XG4gIH1cbn1cblxuLy8gbWVyZ2UgcGFyYW1zIHdpdGggcGFyZW50IHBhcmFtc1xuZnVuY3Rpb24gbWVyZ2VQYXJhbXMocGFyYW1zLCBwYXJlbnQpIHtcbiAgaWYgKHR5cGVvZiBwYXJlbnQgIT09ICdvYmplY3QnIHx8ICFwYXJlbnQpIHtcbiAgICByZXR1cm4gcGFyYW1zO1xuICB9XG5cbiAgLy8gbWFrZSBjb3B5IG9mIHBhcmVudCBmb3IgYmFzZVxuICB2YXIgb2JqID0gbWl4aW4oe30sIHBhcmVudCk7XG5cbiAgLy8gc2ltcGxlIG5vbi1udW1lcmljIG1lcmdpbmdcbiAgaWYgKCEoMCBpbiBwYXJhbXMpIHx8ICEoMCBpbiBwYXJlbnQpKSB7XG4gICAgcmV0dXJuIG1peGluKG9iaiwgcGFyYW1zKTtcbiAgfVxuXG4gIHZhciBpID0gMDtcbiAgdmFyIG8gPSAwO1xuXG4gIC8vIGRldGVybWluZSBudW1lcmljIGdhcHNcbiAgd2hpbGUgKGkgaW4gcGFyYW1zKSB7XG4gICAgaSsrO1xuICB9XG5cbiAgd2hpbGUgKG8gaW4gcGFyZW50KSB7XG4gICAgbysrO1xuICB9XG5cbiAgLy8gb2Zmc2V0IG51bWVyaWMgaW5kaWNlcyBpbiBwYXJhbXMgYmVmb3JlIG1lcmdlXG4gIGZvciAoaS0tOyBpID49IDA7IGktLSkge1xuICAgIHBhcmFtc1tpICsgb10gPSBwYXJhbXNbaV07XG5cbiAgICAvLyBjcmVhdGUgaG9sZXMgZm9yIHRoZSBtZXJnZSB3aGVuIG5lY2Vzc2FyeVxuICAgIGlmIChpIDwgbykge1xuICAgICAgZGVsZXRlIHBhcmFtc1tpXTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbWl4aW4ob2JqLCBwYXJhbXMpO1xufVxuXG4vLyByZXN0b3JlIG9iaiBwcm9wcyBhZnRlciBmdW5jdGlvblxuZnVuY3Rpb24gcmVzdG9yZShmbiwgb2JqKSB7XG4gIHZhciBwcm9wcyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMik7XG4gIHZhciB2YWxzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAyKTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgcHJvcHNbaV0gPSBhcmd1bWVudHNbaSArIDJdO1xuICAgIHZhbHNbaV0gPSBvYmpbcHJvcHNbaV1dO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAvLyByZXN0b3JlIHZhbHNcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBvYmpbcHJvcHNbaV1dID0gdmFsc1tpXTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcbn1cblxuLy8gc2VuZCBhbiBPUFRJT05TIHJlc3BvbnNlXG5mdW5jdGlvbiBzZW5kT3B0aW9uc1Jlc3BvbnNlKHJlcywgb3B0aW9ucywgbmV4dCkge1xuICB0cnkge1xuICAgIHZhciBib2R5ID0gb3B0aW9ucy5qb2luKCcsJyk7XG4gICAgcmVzLnNldCgnQWxsb3cnLCBib2R5KTtcbiAgICByZXMuc2VuZChib2R5KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgbmV4dChlcnIpO1xuICB9XG59XG5cbi8vIHdyYXAgYSBmdW5jdGlvblxuZnVuY3Rpb24gd3JhcChvbGQsIGZuKSB7XG4gIHJldHVybiBmdW5jdGlvbiBwcm94eSgpIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoICsgMSk7XG5cbiAgICBhcmdzWzBdID0gb2xkO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGFyZ3NbaSArIDFdID0gYXJndW1lbnRzW2ldO1xuICAgIH1cblxuICAgIGZuLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICB9O1xufVxuIl0sIm5hbWVzIjpbIlJvdXRlIiwiTGF5ZXIiLCJtZXRob2RzIiwibWl4aW4iLCJkZWJ1ZyIsImRlcHJlY2F0ZSIsImZsYXR0ZW4iLCJwYXJzZVVybCIsInNldFByb3RvdHlwZU9mIiwib2JqZWN0UmVnRXhwIiwic2xpY2UiLCJBcnJheSIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwiT2JqZWN0IiwicHJvdG8iLCJtb2R1bGUiLCJleHBvcnRzIiwib3B0aW9ucyIsIm9wdHMiLCJyb3V0ZXIiLCJyZXEiLCJyZXMiLCJuZXh0IiwiaGFuZGxlIiwicGFyYW1zIiwiX3BhcmFtcyIsImNhc2VTZW5zaXRpdmUiLCJtZXJnZVBhcmFtcyIsInN0cmljdCIsInN0YWNrIiwiYXBwZW5kTWV0aG9kcyIsImxpc3QiLCJhZGRpdGlvbiIsImkiLCJsZW5ndGgiLCJtZXRob2QiLCJpbmRleE9mIiwicHVzaCIsImdldHR5cGUiLCJvYmoiLCJ0eXBlIiwiY2FsbCIsInJlcGxhY2UiLCJtYXRjaExheWVyIiwibGF5ZXIiLCJwYXRoIiwibWF0Y2giLCJlcnIiLCJwYXJhbSIsIm5hbWUiLCJmbiIsInRoaXMiLCJyZXQiLCJsZW4iLCJKU09OIiwic3RyaW5naWZ5IiwiRXJyb3IiLCJvdXQiLCJzZWxmIiwidXJsIiwib2xkIiwiaWR4IiwicHJvdG9ob3N0Iiwic2VhcmNoSW5kZXgiLCJwYXRoTGVuZ3RoIiwiZnFkbkluZGV4Iiwic3Vic3RyaW5nIiwidW5kZWZpbmVkIiwiZ2V0UHJvdG9ob3N0IiwicmVtb3ZlZCIsInNsYXNoQWRkZWQiLCJzeW5jIiwicGFyYW1jYWxsZWQiLCJwYXJlbnRQYXJhbXMiLCJwYXJlbnRVcmwiLCJiYXNlVXJsIiwiZG9uZSIsInByb3BzIiwiYXJndW1lbnRzIiwidmFscyIsImFwcGx5IiwicmVzdG9yZSIsImxheWVyRXJyb3IiLCJzZXRJbW1lZGlhdGUiLCJyb3V0ZSIsInBhdGhuYW1lIiwiZ2V0UGF0aG5hbWUiLCJoYXNfbWV0aG9kIiwiX2hhbmRsZXNfbWV0aG9kIiwiX29wdGlvbnMiLCJwYXJlbnQiLCJvIiwibGF5ZXJQYXRoIiwicHJvY2Vzc19wYXJhbXMiLCJoYW5kbGVfcmVxdWVzdCIsImMiLCJvcmlnaW5hbFVybCIsImhhbmRsZV9lcnJvciIsInRyaW1fcHJlZml4IiwiYm9keSIsImpvaW4iLCJzZXQiLCJzZW5kIiwic2VuZE9wdGlvbnNSZXNwb25zZSIsImFyZ3MiLCJjYWxsZWQiLCJrZXlzIiwia2V5IiwicGFyYW1WYWwiLCJwYXJhbUNhbGxiYWNrcyIsInBhcmFtQ2FsbGVkIiwicGFyYW1JbmRleCIsImVycm9yIiwidmFsdWUiLCJwYXJhbUNhbGxiYWNrIiwiZSIsInVzZSIsIm9mZnNldCIsImFyZyIsImlzQXJyYXkiLCJjYWxsYmFja3MiLCJUeXBlRXJyb3IiLCJzZW5zaXRpdmUiLCJlbmQiLCJkaXNwYXRjaCIsImJpbmQiLCJjb25jYXQiLCJmb3JFYWNoIl0sInNvdXJjZVJvb3QiOiIifQ==